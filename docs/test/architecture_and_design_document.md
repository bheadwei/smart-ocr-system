# æ•´åˆæ€§æ¶æ§‹èˆ‡è¨­è¨ˆæ–‡ä»¶ (Unified Architecture & Design Document) - pickle-ocr

graphTB

    subgraph ä½¿ç”¨è€…

    User[ğŸ‘¤ ä½¿ç”¨è€…`<br/>`éœ€è¦é€²è¡Œæ–‡ä»¶ OCR è¾¨è­˜]

    Developer[ğŸ‘¨â€ğŸ’» é–‹ç™¼è€…`<br/>`éœ€è¦æ•´åˆ OCR åŠŸèƒ½]

    end

    subgraph æ ¸å¿ƒç³»çµ±

    OCR[ğŸ”² pickle-ocr`<br/>`ä¼æ¥­ç´šä¸­æ–‡ OCR æ™ºèƒ½è¾¨è­˜ç³»çµ±]

    end

    subgraph å¤–éƒ¨ç³»çµ±

    PaddleOCR[ğŸ“¦ PaddleOCR`<br/>`ç™¾åº¦ OCR æ·±åº¦å­¸ç¿’å¼•æ“]

    FileSystem[ğŸ’¾ æœ¬åœ°æª”æ¡ˆç³»çµ±`<br/>`åœ–ç‰‡è¼¸å…¥èˆ‡çµæœè¼¸å‡ºå„²å­˜]

    end

    User-->|ä½¿ç”¨ CLI è™•ç†åœ–ç‰‡|OCR

    Developer-->|é€é Python API æ•´åˆ|OCR

    OCR-->|å‘¼å«è¾¨è­˜å¼•æ“|PaddleOCR

    OCR-->|è®€å–åœ–ç‰‡/å¯«å…¥çµæœ|FileSystem

    styleOCRfill:#4a90d9,stroke:#2c5aa0,color:#fff

    stylePaddleOCRfill:#f5f5f5,stroke:#999

    styleFileSystemfill:#f5f5f5,stroke:#999

    styleUserfill:#e8f4e8,stroke:#5cb85c

    styleDeveloperfill:#e8f4e8,stroke:#5cb85

---

**æ–‡ä»¶ç‰ˆæœ¬ (Document Version):** `v1.0`
**æœ€å¾Œæ›´æ–° (Last Updated):** `2025-12-19`
**ä¸»è¦ä½œè€… (Lead Author):** Kuan-Wei
**å¯©æ ¸è€… (Reviewers):** Kuan-Wei
**ç‹€æ…‹ (Status):** `å·²æ‰¹å‡† (Approved)`

---

## ç›®éŒ„ (Table of Contents)

- [ç¬¬ 1 éƒ¨åˆ†ï¼šæ¶æ§‹ç¸½è¦½ (Architecture Overview)](#ç¬¬-1-éƒ¨åˆ†æ¶æ§‹ç¸½è¦½-architecture-overview)
  - [1.1 C4 æ¨¡å‹ï¼šè¦–è¦ºåŒ–æ¶æ§‹](#11-c4-æ¨¡å‹è¦–è¦ºåŒ–æ¶æ§‹)
  - [1.2 é ˜åŸŸæ¨¡å‹èˆ‡é€šç”¨èªè¨€](#12-é ˜åŸŸæ¨¡å‹èˆ‡é€šç”¨èªè¨€)
  - [1.3 Clean Architecture åˆ†å±¤](#13-clean-architecture-åˆ†å±¤)
  - [1.4 æŠ€è¡“é¸å‹èˆ‡æ±ºç­–](#14-æŠ€è¡“é¸å‹èˆ‡æ±ºç­–)
- [ç¬¬ 2 éƒ¨åˆ†ï¼šè©³ç´°è¨­è¨ˆ (Detailed Design)](#ç¬¬-2-éƒ¨åˆ†è©³ç´°è¨­è¨ˆ-detailed-design)
  - [2.1 MVP èˆ‡æ¨¡çµ„å„ªå…ˆç´š](#21-mvp-èˆ‡æ¨¡çµ„å„ªå…ˆç´š-mvp--module-priority)
  - [2.2 æ ¸å¿ƒåŠŸèƒ½ï¼šæ¨¡çµ„è¨­è¨ˆ](#22-æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„è¨­è¨ˆ)
  - [2.3 éåŠŸèƒ½æ€§éœ€æ±‚è¨­è¨ˆ](#23-éåŠŸèƒ½æ€§éœ€æ±‚è¨­è¨ˆ-nfrs-design)
- [ç¬¬ 3 éƒ¨åˆ†ï¼šé™„éŒ„ (Appendix)](#ç¬¬-3-éƒ¨åˆ†é™„éŒ„-appendix)

---

**ç›®çš„**: æœ¬æ–‡ä»¶æ—¨åœ¨å°‡ pickle-ocr å°ˆæ¡ˆçš„æ¥­å‹™éœ€æ±‚è½‰åŒ–ç‚ºå®Œæ•´ã€å…§èšçš„æŠ€è¡“è—åœ–ã€‚å¾é«˜å±¤æ¬¡çš„ç³»çµ±æ¶æ§‹é–‹å§‹ï¼Œé€æ­¥æ·±å…¥åˆ°å…·é«”çš„æ¨¡çµ„ç´šå¯¦ç¾ç´°ç¯€ï¼Œç¢ºä¿ç³»çµ±çš„ç©©å›ºæ€§èˆ‡å¯ç¶­è­·æ€§ã€‚

---

## ç¬¬ 1 éƒ¨åˆ†ï¼šæ¶æ§‹ç¸½è¦½ (Architecture Overview)

*æ­¤éƒ¨åˆ†é—œæ³¨ç³»çµ±çš„å®è§€çµæ§‹èˆ‡æŒ‡å°åŸå‰‡ï¼Œå›ç­”ã€Œç³»çµ±ç”±ä»€éº¼çµ„æˆï¼Ÿã€ä»¥åŠã€Œå®ƒå€‘ä¹‹é–“å¦‚ä½•äº’å‹•ï¼Ÿã€ã€‚*

### 1.1 C4 æ¨¡å‹ï¼šè¦–è¦ºåŒ–æ¶æ§‹

#### L1 - ç³»çµ±æƒ…å¢ƒåœ– (System Context Diagram)

*æè¿° pickle-ocr ç³»çµ±èˆ‡å¤–éƒ¨ä½¿ç”¨è€…/ç³»çµ±çš„äº’å‹•ã€‚*

```mermaid
graph TB
    subgraph ä½¿ç”¨è€…
        User[ğŸ‘¤ ä½¿ç”¨è€…<br/>éœ€è¦é€²è¡Œæ–‡ä»¶ OCR è¾¨è­˜]
        Developer[ğŸ‘¨â€ğŸ’» é–‹ç™¼è€…<br/>éœ€è¦æ•´åˆ OCR åŠŸèƒ½]
    end

    subgraph æ ¸å¿ƒç³»çµ±
        OCR[ğŸ”² pickle-ocr<br/>ä¼æ¥­ç´šä¸­æ–‡ OCR æ™ºèƒ½è¾¨è­˜ç³»çµ±]
    end

    subgraph å¤–éƒ¨ç³»çµ±
        PaddleOCR[ğŸ“¦ PaddleOCR<br/>ç™¾åº¦ OCR æ·±åº¦å­¸ç¿’å¼•æ“]
        FileSystem[ğŸ’¾ æœ¬åœ°æª”æ¡ˆç³»çµ±<br/>åœ–ç‰‡è¼¸å…¥èˆ‡çµæœè¼¸å‡ºå„²å­˜]
    end

    User -->|ä½¿ç”¨ CLI è™•ç†åœ–ç‰‡| OCR
    Developer -->|é€é Python API æ•´åˆ| OCR
    OCR -->|å‘¼å«è¾¨è­˜å¼•æ“| PaddleOCR
    OCR -->|è®€å–åœ–ç‰‡/å¯«å…¥çµæœ| FileSystem

    style OCR fill:#4a90d9,stroke:#2c5aa0,color:#fff
    style PaddleOCR fill:#f5f5f5,stroke:#999
    style FileSystem fill:#f5f5f5,stroke:#999
    style User fill:#e8f4e8,stroke:#5cb85c
    style Developer fill:#e8f4e8,stroke:#5cb85c

```

**èªªæ˜ï¼š**

- **ä½¿ç”¨è€…**ï¼šé€éå‘½ä»¤åˆ—ä»‹é¢ (CLI) èˆ‡ç³»çµ±äº’å‹•ï¼Œè™•ç†å–®ä¸€åœ–ç‰‡æˆ–æ‰¹é‡è³‡æ–™å¤¾
- **é–‹ç™¼è€…**ï¼šé€é Python API å°‡ OCR åŠŸèƒ½æ•´åˆè‡³ç¾æœ‰å°ˆæ¡ˆ
- **PaddleOCR**ï¼šåº•å±¤æ·±åº¦å­¸ç¿’ OCR å¼•æ“ï¼Œè² è²¬å¯¦éš›çš„æ–‡å­—è¾¨è­˜å·¥ä½œ
- **æœ¬åœ°æª”æ¡ˆç³»çµ±**ï¼šæä¾›åœ–ç‰‡è¼¸å…¥ä¾†æºèˆ‡è¾¨è­˜çµæœè¼¸å‡ºå„²å­˜

#### L2 - å®¹å™¨åœ– (Container Diagram)

*æè¿°ç³»çµ±ç”±å“ªäº›å¯éƒ¨ç½²å–®å…ƒçµ„æˆã€‚*

```mermaid
graph TB
    User[ğŸ‘¤ ä½¿ç”¨è€…/é–‹ç™¼è€…]

    subgraph pickle-ocr System
        CLI[ğŸ“Ÿ CLI æ¨¡çµ„<br/>Python/argparse<br/>æä¾›å‘½ä»¤åˆ—ä»‹é¢]
        API[ğŸ”Œ Python API<br/>Python Module<br/>æä¾›ç¨‹å¼åŒ–ä»‹é¢]
        Engine[âš™ï¸ OCR Engine<br/>Python/PaddleOCR<br/>æ ¸å¿ƒè¾¨è­˜å¼•æ“]
        Config[âš¡ Config Manager<br/>Python/dataclass<br/>é…ç½®ç®¡ç†]
        Exporter[ğŸ“¤ Result Exporter<br/>Python<br/>å¤šæ ¼å¼åŒ¯å‡º]
    end

    subgraph å¤–éƒ¨ç³»çµ±
        PaddleOCR[ğŸ“¦ PaddleOCR Engine]
        FileSystem[ğŸ’¾ æª”æ¡ˆç³»çµ±]
    end

    User -->|å‘½ä»¤åˆ—æ“ä½œ| CLI
    User -->|Python Import| API
    CLI -->|è™•ç†è«‹æ±‚| Engine
    API -->|è™•ç†è«‹æ±‚| Engine
    Engine -->|è®€å–é…ç½®| Config
    Engine -->|åŒ¯å‡ºçµæœ| Exporter
    Engine -->|å‘¼å«è¾¨è­˜| PaddleOCR
    Exporter -->|å¯«å…¥æª”æ¡ˆ| FileSystem

    style CLI fill:#5dade2,stroke:#2980b9,color:#fff
    style API fill:#5dade2,stroke:#2980b9,color:#fff
    style Engine fill:#f39c12,stroke:#d68910,color:#fff
    style Config fill:#58d68d,stroke:#28b463,color:#fff
    style Exporter fill:#58d68d,stroke:#28b463,color:#fff
    style PaddleOCR fill:#f5f5f5,stroke:#999
    style FileSystem fill:#f5f5f5,stroke:#999
```

#### L3 - å…ƒä»¶åœ– (Component Diagram)

*é‡å°æ ¸å¿ƒå®¹å™¨ï¼Œæ‹†è§£å…¶å…§éƒ¨çš„æ¨¡çµ„æˆ–å…ƒä»¶ã€‚*

```mermaid
graph TB
    subgraph "pickle-ocr å…ƒä»¶æ¶æ§‹"
        subgraph "ä»‹é¢å±¤ (Interface Layer)"
            CLI[cli.py<br/>å‘½ä»¤åˆ—ä»‹é¢]
            API[__init__.py<br/>Python API å…¥å£]
        end

        subgraph "æ ¸å¿ƒå±¤ (Core Layer)"
            Engine[OCREngine<br/>è¾¨è­˜å¼•æ“]
            Config[OCRConfig<br/>é…ç½®ç®¡ç†]
            Result[OCRResult<br/>çµæœå®¹å™¨]
            Line[OCRLine<br/>è¡Œè³‡æ–™æ¨¡å‹]
        end

        subgraph "åŒ¯å‡ºå±¤ (Export Layer)"
            TXT[TXT Exporter]
            JSON[JSON Exporter]
            CSV[CSV Exporter]
            XLSX[XLSX Exporter]
        end

        subgraph "å¤–éƒ¨ä¾è³´ (External Dependencies)"
            PaddleOCR[PaddleOCR<br/>æ·±åº¦å­¸ç¿’å¼•æ“]
            CUDA[CUDA/cuDNN<br/>GPU åŠ é€Ÿ]
        end
    end

    CLI --> Engine
    API --> Engine
    Engine --> Config
    Engine --> Result
    Result --> Line
    Engine --> TXT
    Engine --> JSON
    Engine --> CSV
    Engine --> XLSX
    Engine --> PaddleOCR
    PaddleOCR -.->|å¯é¸| CUDA
```

### 1.2 é ˜åŸŸæ¨¡å‹èˆ‡é€šç”¨èªè¨€

#### é€šç”¨èªè¨€ (Ubiquitous Language)

| è¡“èª                                  | å®šç¾©                                     | ç¯„ä¾‹                                              |
| ------------------------------------- | ---------------------------------------- | ------------------------------------------------- |
| **OCREngine**                   | æ ¸å¿ƒè¾¨è­˜å¼•æ“ï¼Œè² è²¬å”èª¿æ•´å€‹ OCR è™•ç†æµç¨‹  | `engine = OCREngine(config)`                    |
| **OCRConfig**                   | é…ç½®ç‰©ä»¶ï¼ŒåŒ…å«æ‰€æœ‰å¯èª¿æ•´çš„è¾¨è­˜åƒæ•¸       | `OCRConfig.for_chinese()`                       |
| **OCRResult**                   | å–®ä¸€åœ–ç‰‡çš„è¾¨è­˜çµæœå®¹å™¨ï¼ŒåŒ…å«æ‰€æœ‰è¾¨è­˜è¡Œ   | `result.text`, `result.average_confidence`    |
| **OCRLine**                     | å–®ä¸€è¡Œè¾¨è­˜çµæœï¼ŒåŒ…å«æ–‡å­—ã€ä¿¡å¿ƒåˆ†æ•¸ã€åº§æ¨™ | `line.text`, `line.confidence`, `line.bbox` |
| **ä¿¡å¿ƒåˆ†æ•¸ (Confidence)**       | è¾¨è­˜æº–ç¢ºåº¦æŒ‡æ¨™ï¼Œ0.0 ~ 1.0 ä¹‹é–“           | `0.95` è¡¨ç¤º 95% ä¿¡å¿ƒ                            |
| **åº§æ¨™æ¡† (BBox)**               | æ–‡å­—å€åŸŸçš„å››è§’åº§æ¨™ï¼Œç”¨æ–¼å®šä½æ–‡å­—ä½ç½®     | `[[x1,y1], [x2,y2], [x3,y3], [x4,y4]]`          |
| **æ‰¹é‡è™•ç† (Batch Processing)** | ä¸€æ¬¡è™•ç†æ•´å€‹è³‡æ–™å¤¾çš„æ‰€æœ‰åœ–ç‰‡             | `engine.process_directory(path)`                |
| **éè¿´è™•ç† (Recursive)**        | åŒ…å«å­è³‡æ–™å¤¾çš„æ‰¹é‡è™•ç†æ¨¡å¼               | `--recursive` æˆ– `-r`                         |

#### é™ç•Œä¸Šä¸‹æ–‡ (Bounded Contexts)

æœ¬å°ˆæ¡ˆç‚ºå–®é«”æ‡‰ç”¨ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹ä¸Šä¸‹æ–‡ï¼š

```mermaid
graph LR
    subgraph "pickle-ocr é™ç•Œä¸Šä¸‹æ–‡"
        A[è¾¨è­˜ä¸Šä¸‹æ–‡<br/>Recognition Context]
        B[é…ç½®ä¸Šä¸‹æ–‡<br/>Configuration Context]
        C[åŒ¯å‡ºä¸Šä¸‹æ–‡<br/>Export Context]
    end

    A -->|ä½¿ç”¨é…ç½®| B
    A -->|ç”¢ç”Ÿçµæœ| C
```

| ä¸Šä¸‹æ–‡               | è·è²¬                                       | æ ¸å¿ƒé¡åˆ¥                                  |
| -------------------- | ------------------------------------------ | ----------------------------------------- |
| **è¾¨è­˜ä¸Šä¸‹æ–‡** | è™•ç†åœ–ç‰‡è¼¸å…¥ã€å‘¼å« PaddleOCRã€ç”¢ç”Ÿè¾¨è­˜çµæœ | `OCREngine`, `OCRResult`, `OCRLine` |
| **é…ç½®ä¸Šä¸‹æ–‡** | ç®¡ç†è¾¨è­˜åƒæ•¸ã€èªè¨€è¨­å®šã€GPU è¨­å®š           | `OCRConfig`                             |
| **åŒ¯å‡ºä¸Šä¸‹æ–‡** | å°‡è¾¨è­˜çµæœè½‰æ›ç‚ºä¸åŒæ ¼å¼è¼¸å‡º               | `export_*` æ–¹æ³•                         |

### 1.3 Clean Architecture åˆ†å±¤

*pickle-ocr éµå¾ª Clean Architecture åŸå‰‡ï¼Œç¢ºä¿é—œæ³¨é»åˆ†é›¢ã€‚*

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»‹é¢å±¤ (Interface Layer)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   CLI (cli.py)   â”‚  â”‚  Python API (__init__.py)        â”‚ â”‚
â”‚  â”‚  - argparse      â”‚  â”‚  - å…¬é–‹ OCREngine, OCRConfig     â”‚ â”‚
â”‚  â”‚  - å‘½ä»¤è™•ç†      â”‚  â”‚  - å…¬é–‹ OCRResult                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   æ‡‰ç”¨å±¤ (Application Layer)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  OCREngine (ocr_engine.py)                              â”‚â”‚
â”‚  â”‚  - process_image(): è™•ç†å–®ä¸€åœ–ç‰‡                        â”‚â”‚
â”‚  â”‚  - process_directory(): æ‰¹é‡è™•ç†è³‡æ–™å¤¾                  â”‚â”‚
â”‚  â”‚  - export_results(): åŒ¯å‡ºè¾¨è­˜çµæœ                       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    é ˜åŸŸå±¤ (Domain Layer)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   OCRConfig    â”‚  â”‚   OCRResult    â”‚  â”‚    OCRLine     â”‚ â”‚
â”‚  â”‚  - é…ç½®åƒæ•¸    â”‚  â”‚  - çµæœå®¹å™¨    â”‚  â”‚  - è¡Œè³‡æ–™      â”‚ â”‚
â”‚  â”‚  - å·¥å» æ–¹æ³•    â”‚  â”‚  - å±¬æ€§è¨ˆç®—    â”‚  â”‚  - åºåˆ—åŒ–     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  åŸºç¤è¨­æ–½å±¤ (Infrastructure Layer)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   PaddleOCR      â”‚  â”‚  æª”æ¡ˆç³»çµ±æ“ä½œ                    â”‚ â”‚
â”‚  â”‚  - æ·±åº¦å­¸ç¿’å¼•æ“  â”‚  â”‚  - åœ–ç‰‡è®€å–                      â”‚ â”‚
â”‚  â”‚  - GPU åŠ é€Ÿ      â”‚  â”‚  - çµæœè¼¸å‡º (TXT/JSON/CSV/XLSX)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ†å±¤è·è²¬ï¼š**

| å±¤ç´š                 | è·è²¬                                           | ä¾è³´æ–¹å‘       |
| -------------------- | ---------------------------------------------- | -------------- |
| **ä»‹é¢å±¤**     | è™•ç†ä½¿ç”¨è€…è¼¸å…¥ï¼Œå°‡è«‹æ±‚è½‰æ›ç‚ºæ‡‰ç”¨å±¤å¯ç†è§£çš„æ ¼å¼ | å‘å…§ä¾è³´æ‡‰ç”¨å±¤ |
| **æ‡‰ç”¨å±¤**     | å”èª¿æ¥­å‹™æµç¨‹ï¼Œçµ„åˆé ˜åŸŸç‰©ä»¶å®Œæˆç”¨ä¾‹             | å‘å…§ä¾è³´é ˜åŸŸå±¤ |
| **é ˜åŸŸå±¤**     | å®šç¾©æ ¸å¿ƒæ¥­å‹™è¦å‰‡èˆ‡è³‡æ–™çµæ§‹ï¼Œç„¡å¤–éƒ¨ä¾è³´         | ç„¡ä¾è³´ï¼ˆæ ¸å¿ƒï¼‰ |
| **åŸºç¤è¨­æ–½å±¤** | å¯¦ç¾èˆ‡å¤–éƒ¨ç³»çµ±çš„äº’å‹•ï¼ˆOCR å¼•æ“ã€æª”æ¡ˆç³»çµ±ï¼‰     | è¢«å…¶ä»–å±¤ä½¿ç”¨   |

### 1.4 æŠ€è¡“é¸å‹èˆ‡æ±ºç­–

#### æŠ€è¡“é¸å‹åŸå‰‡

1. **æœ¬åœ°å„ªå…ˆ (Local-First)**ï¼šç³»çµ±è¨­è¨ˆç‚ºæœ¬åœ°åŸ·è¡Œï¼Œç„¡éœ€ç¶²è·¯é€£ç·šï¼Œä¿éšœè³‡æ–™éš±ç§
2. **æ•ˆèƒ½å°å‘ (Performance-Oriented)**ï¼šæ”¯æ´ GPU åŠ é€Ÿï¼Œå„ªåŒ–æ‰¹é‡è™•ç†æ•ˆèƒ½
3. **æ˜“æ–¼æ•´åˆ (Easy Integration)**ï¼šæä¾› CLI èˆ‡ Python API é›™ä»‹é¢
4. **é–‹æºå„ªå…ˆ (Open-Source First)**ï¼šæ¡ç”¨é–‹æºæŠ€è¡“æ£§ï¼Œé™ä½æˆæ¬Šæˆæœ¬

#### æŠ€è¡“æ£§è©³æƒ…

| åˆ†é¡                   | é¸ç”¨æŠ€è¡“              | é¸æ“‡ç†ç”±                                 | å‚™é¸æ–¹æ¡ˆ            | ç›¸é—œæ±ºç­– |
| ---------------------- | --------------------- | ---------------------------------------- | ------------------- | -------- |
| **ç¨‹å¼èªè¨€**     | Python 3.10+          | PaddleOCR åŸç”Ÿæ”¯æ´ã€ç”Ÿæ…‹è±å¯Œã€é–‹ç™¼æ•ˆç‡é«˜ | -                   | D-002    |
| **OCR å¼•æ“**     | PaddleOCR 2.9.1       | ä¸­æ–‡è¾¨è­˜æ•ˆæœå„ªç•°ã€é–‹æºå…è²»ã€æ”¯æ´ GPU     | Tesseractã€EasyOCR  | D-001    |
| **æ·±åº¦å­¸ç¿’æ¡†æ¶** | PaddlePaddle 2.6.2    | PaddleOCR ä¾è³´ã€ç™¾åº¦ç¶­è­·ã€æ•ˆèƒ½å„ªç•°       | PyTorchã€TensorFlow | D-001    |
| **CLI æ¡†æ¶**     | argparse              | Python å…§å»ºã€ç„¡é¡å¤–ä¾è³´ã€åŠŸèƒ½å®Œæ•´        | Clickã€Typer        | D-003    |
| **é…ç½®ç®¡ç†**     | dataclass             | Python å…§å»ºã€å‹åˆ¥å®‰å…¨ã€æ˜“æ–¼æ“´å±•          | Pydantic            | -        |
| **Excel åŒ¯å‡º**   | openpyxl              | ç´” Pythonã€åŠŸèƒ½å®Œæ•´ã€æ´»èºç¶­è­·            | xlsxwriter          | -        |
| **GPU åŠ é€Ÿ**     | CUDA 11.x + cuDNN 8.x | PaddlePaddle å®˜æ–¹æ”¯æ´ç‰ˆæœ¬                | -                   | -        |
| **å¥—ä»¶ç®¡ç†**     | uv                    | å®‰è£é€Ÿåº¦å¿«ã€ç›¸å®¹ pip                     | pipã€poetry         | D-004    |
| **æ¸¬è©¦æ¡†æ¶**     | pytest                | Python ç¤¾ç¾¤æ¨™æº–ã€åŠŸèƒ½å®Œæ•´                | unittest            | -        |

#### æ¶æ§‹æ±ºç­–è¨˜éŒ„ (ADR) æ‘˜è¦

| ID              | æ±ºç­–                        | ç‹€æ…‹   | ç†ç”±                                 |
| --------------- | --------------------------- | ------ | ------------------------------------ |
| **D-001** | æ¡ç”¨ PaddleOCR ä½œç‚ºæ ¸å¿ƒå¼•æ“ | å·²æ±ºå®š | ä¸­æ–‡è¾¨è­˜æ•ˆæœå„ªæ–¼ Tesseractã€å…è²»é–‹æº |
| **D-002** | ä½¿ç”¨ Python ä½œç‚ºé–‹ç™¼èªè¨€    | å·²æ±ºå®š | æ·±åº¦å­¸ç¿’ç”Ÿæ…‹å®Œæ•´ã€é–‹ç™¼æ•ˆç‡é«˜         |
| **D-003** | CLI æ¡ç”¨ argparse           | å·²æ±ºå®š | å…§å»ºæ¨¡çµ„ã€ç„¡é¡å¤–ä¾è³´ã€åŠŸèƒ½è¶³å¤        |
| **D-004** | å¥—ä»¶ç®¡ç†æ¡ç”¨ uv             | å·²æ±ºå®š | å®‰è£é€Ÿåº¦å¿«ã€ç›¸å®¹ç¾æœ‰ pip ç”Ÿæ…‹        |

---

## ç¬¬ 2 éƒ¨åˆ†ï¼šè©³ç´°è¨­è¨ˆ (Detailed Design)

*æ­¤éƒ¨åˆ†é—œæ³¨å…·é«”æ¨¡çµ„çš„å¯¦ç¾ç´°ç¯€ï¼Œå›ç­”ã€Œæ¯å€‹éƒ¨åˆ†å¦‚ä½•å·¥ä½œï¼Ÿã€ã€‚*

### 2.1 MVP èˆ‡æ¨¡çµ„å„ªå…ˆç´š (MVP & Module Priority)

*æ ¹æ“š [PRD](./project_brief_and_prd.md) ä¸­çš„ä½¿ç”¨è€…æ•…äº‹ï¼Œå®šç¾©æœ€å°å¯è¡Œç”¢å“ (MVP) çš„ç¯„åœã€‚*

#### MVP ç¯„åœ (Phase 1)

| å„ªå…ˆç´š | æ¨¡çµ„          | å°æ‡‰ User Story        | ç‹€æ…‹    |
| ------ | ------------- | ---------------------- | ------- |
| P0     | å–®ä¸€åœ–ç‰‡è¾¨è­˜  | US-001                 | âœ… å®Œæˆ |
| P0     | é…ç½®ç®¡ç†      | US-009                 | âœ… å®Œæˆ |
| P0     | TXT/JSON åŒ¯å‡º | US-002, US-006         | âœ… å®Œæˆ |
| P1     | CLI ä»‹é¢      | US-001, US-002, US-003 | âœ… å®Œæˆ |
| P1     | æ‰¹é‡è™•ç†      | US-004, US-005         | âœ… å®Œæˆ |
| P1     | CSV/XLSX åŒ¯å‡º | US-007                 | âœ… å®Œæˆ |
| P1     | GPU åŠ é€Ÿ      | US-003                 | âœ… å®Œæˆ |
| P2     | Python API    | US-008, US-009         | âœ… å®Œæˆ |

#### å¾ŒçºŒåŠŸèƒ½ (Post-MVP)

| å„ªå…ˆç´š | åŠŸèƒ½          | å°æ‡‰å•é¡Œ | ç‹€æ…‹   |
| ------ | ------------- | -------- | ------ |
| P3     | è‡ªè¨‚æ¨¡å‹åŒ¯å…¥  | Q-001    | å¾…è¨è«– |
| P3     | ç‰ˆé¢åˆ†æ      | Q-002    | å¾…è¨è«– |
| P3     | Docker æ˜ åƒæª” | Q-003    | å¾…è¨è«– |

### 2.2 æ ¸å¿ƒåŠŸèƒ½ï¼šæ¨¡çµ„è¨­è¨ˆ

#### æ¨¡çµ„ï¼šOCRConfig (é…ç½®ç®¡ç†)

**è·è²¬**ï¼šç®¡ç†æ‰€æœ‰ OCR è¾¨è­˜ç›¸é—œçš„é…ç½®åƒæ•¸

**è³‡æ–™æ¨¡å‹**ï¼š

```python
@dataclass
class OCRConfig:
    # èªè¨€è¨­å®š
    lang: str = "ch"              # è¾¨è­˜èªè¨€ (ch/en)
    use_angle_cls: bool = True    # æ–‡å­—æ–¹å‘åˆ†é¡

    # æ•ˆèƒ½è¨­å®š
    use_gpu: bool = False         # GPU åŠ é€Ÿ
    gpu_mem: int = 500            # GPU è¨˜æ†¶é«”é™åˆ¶ (MB)
    cpu_threads: int = 10         # CPU åŸ·è¡Œç·’æ•¸

    # åµæ¸¬è¨­å®š
    det_algorithm: str = "DB"     # åµæ¸¬æ¼”ç®—æ³•
    det_db_thresh: float = 0.3    # åµæ¸¬é–¾å€¼
    det_db_box_thresh: float = 0.6

    # è¼¸å‡ºè¨­å®š
    output_dir: Path              # è¼¸å‡ºç›®éŒ„
    export_formats: List[str]     # æ”¯æ´çš„åŒ¯å‡ºæ ¼å¼
```

**å·¥å» æ–¹æ³•**ï¼š

| æ–¹æ³•              | ç”¨é€”           | ç‰¹æ®Šé…ç½®                              |
| ----------------- | -------------- | ------------------------------------- |
| `for_chinese()` | ä¸­æ–‡å„ªåŒ–é…ç½®   | å•Ÿç”¨è§’åº¦åˆ†é¡ã€èª¿æ•´åµæ¸¬é–¾å€¼            |
| `for_english()` | è‹±æ–‡å„ªåŒ–é…ç½®   | åœç”¨è§’åº¦åˆ†é¡                          |
| `from_env()`    | å¾ç’°å¢ƒè®Šæ•¸è®€å– | æ”¯æ´ `OCR_LANG`, `OCR_USE_GPU` ç­‰ |

#### æ¨¡çµ„ï¼šOCREngine (è¾¨è­˜å¼•æ“)

**è·è²¬**ï¼šæ ¸å¿ƒè¾¨è­˜å¼•æ“ï¼Œå”èª¿æ•´å€‹ OCR è™•ç†æµç¨‹

**é¡åˆ¥åœ–**ï¼š

```mermaid
classDiagram
    class OCREngine {
        -config: OCRConfig
        -_ocr: PaddleOCR
        -_initialized: bool
        +__init__(config: OCRConfig)
        +process_image(path: Path) OCRResult
        +process_directory(path: Path, recursive: bool) List~OCRResult~
        +export_results(results: List, path: Path, format: str) Path
        -_ensure_initialized() void
        -_export_json(results, path) void
        -_export_csv(results, path) void
        -_export_txt(results, path) void
        -_export_xlsx(results, path) void
    }

    class OCRResult {
        +source_file: Path
        +lines: List~OCRLine~
        +text: str
        +average_confidence: float
        +from_paddle_result(result, path)$ OCRResult
        +to_dict() Dict
    }

    class OCRLine {
        +text: str
        +confidence: float
        +bbox: List~List~float~~
        +to_dict() Dict
    }

    OCREngine --> OCRConfig : uses
    OCREngine --> OCRResult : creates
    OCRResult --> OCRLine : contains
```

**æ ¸å¿ƒæµç¨‹**ï¼š

```mermaid
sequenceDiagram
    participant User as ä½¿ç”¨è€…
    participant CLI as CLI
    participant Engine as OCREngine
    participant Paddle as PaddleOCR
    participant FS as æª”æ¡ˆç³»çµ±

    User->>CLI: smart-ocr process image.png
    CLI->>Engine: process_image(path)
    Engine->>Engine: _ensure_initialized()
    Engine->>Paddle: PaddleOCR.ocr(image_path)
    Paddle-->>Engine: raw_result
    Engine->>Engine: OCRResult.from_paddle_result()
    Engine-->>CLI: OCRResult
    CLI-->>User: é¡¯ç¤ºè¾¨è­˜çµæœ

    opt æŒ‡å®šè¼¸å‡ºæª”æ¡ˆ
        CLI->>Engine: export_results(results, path, format)
        Engine->>FS: å¯«å…¥æª”æ¡ˆ
        Engine-->>CLI: output_path
        CLI-->>User: çµæœå·²åŒ¯å‡º
    end
```

**é—œéµæ¼”ç®—æ³•**ï¼š

1. **å»¶é²åˆå§‹åŒ– (Lazy Initialization)**ï¼š

   - PaddleOCR å¼•æ“åœ¨é¦–æ¬¡ä½¿ç”¨æ™‚æ‰åˆå§‹åŒ–
   - é¿å…è¼‰å…¥æ™‚çš„é•·æ™‚é–“ç­‰å¾…
   - GPU ç’°å¢ƒè¨­å®šåœ¨åˆå§‹åŒ–æ™‚è™•ç†
2. **PaddleOCR çµæœè§£æ**ï¼š

   ```python
   # PaddleOCR 2.x è¼¸å‡ºæ ¼å¼
   result = [
       [  # é é¢çµæœ
           [bbox, (text, confidence)],
           [bbox, (text, confidence)],
           ...
       ]
   ]
   # è§£æç‚º OCRLine ç‰©ä»¶åˆ—è¡¨
   ```

#### æ¨¡çµ„ï¼šCLI (å‘½ä»¤åˆ—ä»‹é¢)

**è·è²¬**ï¼šæä¾›ä½¿ç”¨è€…å‹å–„çš„å‘½ä»¤åˆ—ä»‹é¢

**å‘½ä»¤çµæ§‹**ï¼š

```
smart-ocr
â”œâ”€â”€ --version, -v       # é¡¯ç¤ºç‰ˆæœ¬è³‡è¨Š
â”œâ”€â”€ process             # è™•ç†åœ–ç‰‡å‘½ä»¤
â”‚   â”œâ”€â”€ input           # è¼¸å…¥åœ–ç‰‡æˆ–è³‡æ–™å¤¾ (å¿…è¦)
â”‚   â”œâ”€â”€ --output, -o    # è¼¸å‡ºæª”æ¡ˆè·¯å¾‘
â”‚   â”œâ”€â”€ --format, -f    # è¼¸å‡ºæ ¼å¼ (txt/json/csv/xlsx)
â”‚   â”œâ”€â”€ --lang, -l      # è¾¨è­˜èªè¨€ (ch/en)
â”‚   â”œâ”€â”€ --gpu           # å•Ÿç”¨ GPU åŠ é€Ÿ
â”‚   â”œâ”€â”€ --recursive, -r # éè¿´è™•ç†
â”‚   â””â”€â”€ --quiet, -q     # éœé»˜æ¨¡å¼
â””â”€â”€ config              # é…ç½®å‘½ä»¤
    â””â”€â”€ --show          # é¡¯ç¤ºç›®å‰é…ç½®
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š

```bash
# è™•ç†å–®ä¸€åœ–ç‰‡
smart-ocr process image.png

# æ‰¹é‡è™•ç†è³‡æ–™å¤¾ (éè¿´ + GPU + JSON è¼¸å‡º)
smart-ocr process ./documents/ -r --gpu -o results.json -f json

# æŸ¥çœ‹ç›®å‰é…ç½®
smart-ocr config --show
```

### 2.3 éåŠŸèƒ½æ€§éœ€æ±‚è¨­è¨ˆ (NFRs Design)

*æè¿°å¦‚ä½•å¯¦ç¾ PRD ä¸­å®šç¾©çš„éåŠŸèƒ½æ€§éœ€æ±‚ã€‚*

#### æ€§èƒ½ (Performance)

| éœ€æ±‚                | è¨­è¨ˆæ±ºç­–                | å¯¦ç¾æ–¹å¼                     |
| ------------------- | ----------------------- | ---------------------------- |
| å–®å¼µåœ–ç‰‡ CPU < 3 ç§’ | ä½¿ç”¨ PaddleOCR å„ªåŒ–æ¨¡å‹ | é è¨­ä½¿ç”¨ SVTR_LCNet è¾¨è­˜æ¨¡å‹ |
| å–®å¼µåœ–ç‰‡ GPU < 1 ç§’ | æ”¯æ´ CUDA åŠ é€Ÿ          | è‡ªå‹•è¨­å®š CUDA/cuDNN ç’°å¢ƒ     |
| è¨˜æ†¶é«” < 2GB        | å»¶é²åˆå§‹åŒ– + ä¸²æµè™•ç†   | é€ä¸€è™•ç†åœ–ç‰‡ï¼Œä¸é è¼‰å…¨éƒ¨     |

#### å¯é æ€§ (Reliability)

| éœ€æ±‚         | è¨­è¨ˆæ±ºç­–               | å¯¦ç¾æ–¹å¼                    |
| ------------ | ---------------------- | --------------------------- |
| æ‰¹é‡è™•ç†å®¹éŒ¯ | å–®ä¸€æª”æ¡ˆå¤±æ•—ä¸ä¸­æ–·æ•´é«” | try-except åŒ…è£æ¯å¼µåœ–ç‰‡è™•ç† |
| éŒ¯èª¤è¨˜éŒ„     | è©³ç´°çš„æ—¥èªŒè¼¸å‡º         | ä½¿ç”¨ logging æ¨¡çµ„è¨˜éŒ„éŒ¯èª¤   |
| è¼¸å…¥é©—è­‰     | æå‰é©—è­‰æª”æ¡ˆå­˜åœ¨æ€§     | è™•ç†å‰æª¢æŸ¥è·¯å¾‘æœ‰æ•ˆæ€§        |

#### å¯ç¶­è­·æ€§ (Maintainability)

| éœ€æ±‚               | è¨­è¨ˆæ±ºç­–       | å¯¦ç¾æ–¹å¼                     |
| ------------------ | -------------- | ---------------------------- |
| ç¨‹å¼ç¢¼è¦†è“‹ç‡ > 80% | å®Œæ•´çš„å–®å…ƒæ¸¬è©¦ | pytest + æ¸¬è©¦å›ºä»¶ (fixtures) |
| ç¬¦åˆ PEP 8         | ç¨‹å¼ç¢¼é¢¨æ ¼æª¢æŸ¥ | black + isort + flake8       |
| å®Œæ•´ Type Hints    | éœæ…‹å‹åˆ¥æª¢æŸ¥   | mypy + å‹åˆ¥æ¨™è¨»              |

#### å¯ç”¨æ€§ (Usability)

| éœ€æ±‚           | è¨­è¨ˆæ±ºç­–             | å¯¦ç¾æ–¹å¼                |
| -------------- | -------------------- | ----------------------- |
| æ¸…æ™°çš„éŒ¯èª¤è¨Šæ¯ | ä½¿ç”¨è€…å‹å–„çš„ä¾‹å¤–è™•ç† | è‡ªè¨‚éŒ¯èª¤é¡åˆ¥ + è©³ç´°èªªæ˜ |
| è™•ç†é€²åº¦é¡¯ç¤º   | æ‰¹é‡è™•ç†æ™‚é¡¯ç¤ºé€²åº¦   | è¼¸å‡ºè™•ç†çš„æª”æ¡ˆæ•¸é‡      |
| UTF-8 æ”¯æ´     | Windows çµ‚ç«¯æ©Ÿç›¸å®¹   | è‡ªå‹•è¨­å®š stdout ç·¨ç¢¼    |

---

## ç¬¬ 3 éƒ¨åˆ†ï¼šé™„éŒ„ (Appendix)

### 3.1 å°ˆæ¡ˆç›®éŒ„çµæ§‹

```
pickle-ocr/
â”œâ”€â”€ src/smart_ocr/           # åŸå§‹ç¢¼
â”‚   â”œâ”€â”€ __init__.py          # å¥—ä»¶åˆå§‹åŒ– + Python API å…¥å£
â”‚   â”œâ”€â”€ cli.py               # å‘½ä»¤åˆ—ä»‹é¢
â”‚   â””â”€â”€ core/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ config.py        # OCRConfig é…ç½®ç®¡ç†
â”‚       â””â”€â”€ ocr_engine.py    # OCREngine, OCRResult, OCRLine
â”œâ”€â”€ tests/                   # æ¸¬è©¦å¥—ä»¶
â”‚   â”œâ”€â”€ unit/                # å–®å…ƒæ¸¬è©¦
â”‚   â”‚   â”œâ”€â”€ test_config.py
â”‚   â”‚   â””â”€â”€ test_ocr_engine.py
â”‚   â”œâ”€â”€ integration/         # æ•´åˆæ¸¬è©¦
â”‚   â”‚   â””â”€â”€ test_cli.py
â”‚   â””â”€â”€ conftest.py          # å…±ç”¨ fixtures
â”œâ”€â”€ docs/                    # æ–‡ä»¶
â”‚   â”œâ”€â”€ project_brief_and_prd.md
â”‚   â””â”€â”€ architecture_and_design_document.md
â”œâ”€â”€ output/                  # é è¨­è¼¸å‡ºç›®éŒ„
â”œâ”€â”€ pyproject.toml           # å°ˆæ¡ˆé…ç½®
â”œâ”€â”€ CLAUDE.md                # é–‹ç™¼è¦å‰‡
â””â”€â”€ README.md                # å°ˆæ¡ˆèªªæ˜
```

### 3.2 ä¾è³´é—œä¿‚åœ–

```mermaid
graph TD
    subgraph "pickle-ocr ä¾è³´é—œä¿‚"
        A[cli.py] --> B[OCREngine]
        A --> C[OCRConfig]
        B --> C
        B --> D[OCRResult]
        D --> E[OCRLine]
        B --> F[PaddleOCR]
        F --> G[PaddlePaddle]
        G -.->|å¯é¸| H[CUDA/cuDNN]
        B --> I[openpyxl]
    end

    style A fill:#e1f5fe
    style B fill:#fff3e0
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#f3e5f5
    style F fill:#ffebee
    style G fill:#ffebee
    style H fill:#ffebee
    style I fill:#e8f5e9
```

### 3.3 ç’°å¢ƒè®Šæ•¸æ”¯æ´

| è®Šæ•¸åç¨±           | èªªæ˜                          | é è¨­å€¼     |
| ------------------ | ----------------------------- | ---------- |
| `OCR_LANG`       | è¾¨è­˜èªè¨€                      | `ch`     |
| `OCR_USE_GPU`    | å•Ÿç”¨ GPU (`true`/`false`) | `false`  |
| `OCR_OUTPUT_DIR` | è¼¸å‡ºç›®éŒ„                      | `output` |

### 3.4 åŒ¯å‡ºæ ¼å¼è¦æ ¼

#### TXT æ ¼å¼

```
=== æ–‡ä»¶1.png ===
é€™æ˜¯è¾¨è­˜å‡ºä¾†çš„æ–‡å­—å…§å®¹
ç¬¬äºŒè¡Œæ–‡å­—

=== æ–‡ä»¶2.png ===
å¦ä¸€å€‹æ–‡ä»¶çš„å…§å®¹
```

#### JSON æ ¼å¼

```json
[
  {
    "source_file": "æ–‡ä»¶1.png",
    "text": "é€™æ˜¯è¾¨è­˜å‡ºä¾†çš„æ–‡å­—å…§å®¹\nç¬¬äºŒè¡Œæ–‡å­—",
    "average_confidence": 0.95,
    "lines": [
      {
        "text": "é€™æ˜¯è¾¨è­˜å‡ºä¾†çš„æ–‡å­—å…§å®¹",
        "confidence": 0.96,
        "bbox": [[10, 10], [200, 10], [200, 30], [10, 30]]
      }
    ]
  }
]
```

#### CSV æ ¼å¼

| file      | text                   | confidence | bbox          |
| --------- | ---------------------- | ---------- | ------------- |
| æ–‡ä»¶1.png | é€™æ˜¯è¾¨è­˜å‡ºä¾†çš„æ–‡å­—å…§å®¹ | 0.96       | [[10,10],...] |

#### XLSX æ ¼å¼

| æª”æ¡ˆ      | è¡Œè™Ÿ | æ–‡å­—å…§å®¹               | ä¿¡å¿ƒåˆ†æ•¸ | åº§æ¨™          |
| --------- | ---- | ---------------------- | -------- | ------------- |
| æ–‡ä»¶1.png | 1    | é€™æ˜¯è¾¨è­˜å‡ºä¾†çš„æ–‡å­—å…§å®¹ | 96.00%   | [[10,10],...] |

---

**æ–‡ä»¶å¯©æ ¸è¨˜éŒ„ (Review History):**

| æ—¥æœŸ       | å¯©æ ¸äºº   | ç‰ˆæœ¬ | è®Šæ›´æ‘˜è¦/ä¸»è¦åé¥‹                   |
| :--------- | :------- | :--- | :---------------------------------- |
| 2025-12-19 | Kuan-Wei | v1.0 | åˆç‰ˆå»ºç«‹ï¼Œæ ¹æ“š PRD èˆ‡ç¨‹å¼ç¢¼çµæ§‹æ•´ç† |
